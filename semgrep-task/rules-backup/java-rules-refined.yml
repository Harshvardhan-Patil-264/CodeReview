rules:
  # ==========================================
  # JAVA CODING STANDARDS & BEST PRACTICES
  # Only specific, non-vague rules that trigger reliably
  # Security rules removed (covered by community rules)
  # ==========================================

  # Rule 1: Class Names Should Be PascalCase
  - id: java-naming-class-pascal-case
    pattern: |
      class $CLASS {
        ...
      }
    metavariable-regex:
      metavariable: $CLASS
      regex: '^[a-z].*|.*_.*'
    message: "Class names should use PascalCase, not camelCase or snake_case"
    languages: [java]
    severity: WARNING
    metadata:
      category: naming-convention

  # Rule 2: Method Names Should Be camelCase
  - id: java-naming-method-camel-case
    patterns:
      - pattern: |
          $RETURN $METHOD(...) {
            ...
          }
      - metavariable-regex:
          metavariable: $METHOD
          regex: '^[A-Z].*|.*_.*'
      - pattern-not-inside: |
          class $CLASS {
            ...
          }
    message: "Method names should use camelCase, not PascalCase or snake_case"
    languages: [java]
    severity: WARNING
    metadata:
      category: naming-convention

  # Rule 3: Constants Should Be UPPER_SNAKE_CASE
  - id: java-naming-constant-upper-case
    patterns:
      - pattern-either:
          - pattern: |
              static final $TYPE $CONST = ...;
          - pattern: |
              public static final $TYPE $CONST = ...;
          - pattern: |
              private static final $TYPE $CONST = ...;
      - metavariable-regex:
          metavariable: $CONST
          regex: '^[a-z].*|.*[a-z].*'
    message: "Constants should use UPPER_SNAKE_CASE naming"
    languages: [java]
    severity: WARNING
    metadata:
      category: naming-convention

  # Rule 4: Use Try-With-Resources for AutoCloseable
  - id: java-best-practice-try-with-resources
    patterns:
      - pattern-either:
          - pattern: |
              $RESOURCE $VAR = ...;
              try {
                ...
              } finally {
                $VAR.close();
              }
          - pattern: |
              $RESOURCE $VAR = ...;
              try {
                ...
              }
      - pattern-not-inside: |
          try ($RESOURCE $VAR = ...) {
            ...
          }
    message: "Use try-with-resources for AutoCloseable objects to ensure proper resource cleanup"
    languages: [java]
    severity: WARNING
    metadata:
      category: best-practice
      subcategory: resource-management

  # Rule 5: Prefer Optional Over Null Checks
  - id: java-best-practice-prefer-optional
    pattern: |
      if ($VAR == null) {
        return $DEFAULT;
      }
      return $VAR;
    message: "Consider using Optional<T> instead of null checks for better null safety"
    languages: [java]
    severity: INFO
    metadata:
      category: best-practice
      subcategory: null-safety

  # Rule 6: Use Stream API Instead of For Loops
  - id: java-best-practice-prefer-streams
    pattern: |
      List<$TYPE> $RESULT = new ArrayList<>();
      for ($TYPE $ITEM : $LIST) {
        if (...) {
          $RESULT.add($ITEM);
        }
      }
    message: "Consider using Stream API (filter/map/collect) for better readability"
    languages: [java]
    severity: INFO
    metadata:
      category: best-practice
      subcategory: functional-programming

  # Rule 7: Use StringBuilder for String Concatenation in Loops
  - id: java-performance-string-concat-in-loop
    pattern: |
      for (...) {
        ...
        $STR = $STR + ...;
        ...
      }
    message: "Use StringBuilder instead of string concatenation in loops for better performance"
    languages: [java]
    severity: WARNING
    metadata:
      category: performance
      subcategory: string-operations

  # Rule 8: Exception Class Names Should End With Exception
  - id: java-naming-exception-suffix
    patterns:
      - pattern: |
          class $CLASS extends Exception {
            ...
          }
      - metavariable-regex:
          metavariable: $CLASS
          regex: '^(?!.*Exception$).*'
    message: "Exception class names should end with 'Exception' suffix"
    languages: [java]
    severity: WARNING
    metadata:
      category: naming-convention

  # Rule 9: Avoid Empty Catch Blocks
  - id: java-best-practice-no-empty-catch
    pattern: |
      try {
        ...
      } catch ($EX $VAR) {
      }
    message: "Empty catch blocks hide errors. At minimum, log the exception"
    languages: [java]
    severity: ERROR
    metadata:
      category: best-practice
      subcategory: error-handling

  # Rule 10: Use @Override Annotation
  - id: java-best-practice-use-override
    patterns:
      - pattern-either:
          - pattern: |
              public boolean equals(Object $OBJ) {
                ...
              }
          - pattern: |
              public int hashCode() {
                ...
              }
          - pattern: |
              public String toString() {
                ...
              }
      - pattern-not: |
          @Override
          ...
    message: "Use @Override annotation when overriding methods"
    languages: [java]
    severity: WARNING
    metadata:
      category: best-practice

  # Rule 11: Prefer Diamond Operator
  - id: java-best-practice-diamond-operator
    pattern: |
      $TYPE<$GENERIC> $VAR = new $TYPE<$GENERIC>(...);
    message: "Use diamond operator <> for type inference: new Type<>()"
    languages: [java]
    severity: INFO
    metadata:
      category: best-practice
      subcategory: type-inference

  # Rule 12: Use Enhanced For Loop
  - id: java-best-practice-enhanced-for-loop
    pattern: |
      for (int $I = 0; $I < $LIST.size(); $I++) {
        $TYPE $ITEM = $LIST.get($I);
        ...
      }
    message: "Use enhanced for loop (for-each) for better readability: for (Type item : list)"
    languages: [java]
    severity: INFO
    metadata:
      category: best-practice

  # Rule 13: Avoid Magic Numbers
  - id: java-best-practice-no-magic-numbers
    patterns:
      - pattern-either:
          - pattern: |
              if ($VAR == $NUM) { ... }
          - pattern: |
              if ($VAR > $NUM) { ... }
          - pattern: |
              if ($VAR < $NUM) { ... }
      - metavariable-regex:
          metavariable: $NUM
          regex: '^[0-9]{2,}$'
      - pattern-not: |
          if ($VAR == 0) { ... }
      - pattern-not: |
          if ($VAR == 1) { ... }
    message: "Avoid magic numbers. Use named constants for better code clarity"
    languages: [java]
    severity: INFO
    metadata:
      category: best-practice

  # Rule 14: Use Proper Equals Implementation
  - id: java-best-practice-equals-implementation
    patterns:
      - pattern: |
          public boolean equals(Object $OBJ) {
            ...
          }
      - pattern-not: |
          public boolean equals(Object $OBJ) {
            ...
            if (this == $OBJ) return true;
            ...
          }
    message: "equals() should check reference equality (this == obj) first for performance"
    languages: [java]
    severity: WARNING
    metadata:
      category: best-practice

  # Rule 15: Implement hashCode When Overriding equals
  - id: java-best-practice-hashcode-with-equals
    patterns:
      - pattern: |
          class $CLASS {
            ...
            public boolean equals(Object $OBJ) {
              ...
            }
            ...
          }
      - pattern-not-inside: |
          class $CLASS {
            ...
            public int hashCode() {
              ...
            }
            ...
          }
    message: "When overriding equals(), you must also override hashCode() to maintain the contract"
    languages: [java]
    severity: ERROR
    metadata:
      category: best-practice

  # Rule 16: Use Proper Logger Instead of System.out
  - id: java-best-practice-use-logger
    pattern-either:
      - pattern: System.out.println(...);
      - pattern: System.err.println(...);
    message: "Use proper logging framework (SLF4J, Log4j) instead of System.out/err"
    languages: [java]
    severity: WARNING
    metadata:
      category: best-practice
      subcategory: logging

  # Rule 17: Close Resources in Finally or Try-With-Resources
  - id: java-best-practice-close-resources
    patterns:
      - pattern-either:
          - pattern: |
              $RESOURCE $VAR = new $RESOURCE(...);
              ...
          - pattern: |
              $RESOURCE $VAR = $FACTORY.create(...);
              ...
      - pattern-not-inside: |
          try ($RESOURCE $VAR = ...) {
            ...
          }
      - pattern-not-inside: |
          try {
            ...
          } finally {
            $VAR.close();
          }
      - metavariable-regex:
          metavariable: $RESOURCE
          regex: '.*(Stream|Reader|Writer|Connection|Statement|ResultSet)$'
    message: "Resources like streams and connections must be closed. Use try-with-resources or finally block"
    languages: [java]
    severity: ERROR
    metadata:
      category: best-practice
      subcategory: resource-management

  # Rule 18: Prefer Collections.emptyList() Over new ArrayList()
  - id: java-best-practice-empty-collections
    pattern-either:
      - pattern: return new ArrayList<>();
      - pattern: return new HashSet<>();
      - pattern: return new HashMap<>();
    message: "For empty collections, use Collections.emptyList/Set/Map() to avoid unnecessary object creation"
    languages: [java]
    severity: INFO
    metadata:
      category: performance
