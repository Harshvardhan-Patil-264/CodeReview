rules:
  # ==========================================
  # GENERIC CODING RULES (LANGUAGE INDEPENDENT)
  # ==========================================
  # These rules apply to all programming languages and promote
  # clean, maintainable, and professional code.
  
  # Rule 1: Code Must Have Author Information
  # Why: So others know who wrote the code
  # Note: This is enforced by the header-validator.py script
  # which checks for Purpose, Author, Date, and Modified By fields
  
  # Rule 2: Use Meaningful Variable Names
  # Why: Code should explain itself
  - id: generic-single-letter-variable
    pattern-either:
      - pattern: let $X = ...
      - pattern: var $X = ...
      - pattern: const $X = ...
    message: "Rule 2: Use meaningful variable names. Avoid single-letter names except for loop counters"
    languages: [javascript, typescript, python, java, go]
    severity: INFO
    metadata:
      category: naming-convention
      rule: "Generic Rule 2"
  
  # Rule 3: Follow Proper Indentation
  # Why: Makes code easy to read
  # Note: This is typically enforced by linters and formatters (ESLint, Prettier, Black, gofmt, etc.)
  
  # Rule 4: One Function Should Do One Job
  # Why: Easy to test and fix (Single Responsibility Principle)
  - id: generic-function-too-long
    pattern: |
      function $FUNC(...) {
        ...
        ...
        ...
        ...
        ...
        ...
        ...
        ...
        ...
        ...
      }
    message: "Rule 4: One function should do one job. This function appears too long - consider breaking it into smaller functions"
    languages: [javascript, typescript]
    severity: INFO
    metadata:
      category: code-quality
      rule: "Generic Rule 4"
  
  # Rule 5: Always Handle Errors
  # Why: Programs should not crash
  - id: generic-empty-catch-js
    pattern: |
      try {
        ...
      } catch ($E) {
      }
    message: "Rule 5: Always handle errors. Never ignore exceptions - programs should not crash"
    languages: [javascript, typescript, java]
    severity: ERROR
    metadata:
      category: error-handling
      rule: "Generic Rule 5"
  
  - id: generic-empty-catch-python
    pattern: |
      try:
        ...
      except:
        pass
    message: "Rule 5: Always handle errors. Never ignore exceptions - programs should not crash"
    languages: [python]
    severity: ERROR
    metadata:
      category: error-handling
      rule: "Generic Rule 5"
  
  # Rule 6: Avoid Duplicate Code
  # Why: Repetition causes bugs (DRY - Don't Repeat Yourself)
  - id: generic-duplicate-code
    pattern: |
      if ($COND) {
        $BODY
      }
      ...
      if ($COND) {
        $BODY
      }
    message: "Rule 6: Avoid duplicate code. Repetition causes bugs - follow the DRY principle"
    languages: [javascript, typescript, java, go]
    severity: WARNING
    metadata:
      category: code-quality
      rule: "Generic Rule 6"
  
  # Rule 7: Add Comments Only When Needed
  # Why: Code should be self-explanatory
  # Note: Excessive commenting is hard to detect automatically
  # Focus on writing clear, self-documenting code with meaningful names
  
  # Rule 8: Remove Unused Code
  # Why: Clean code is safe code
  - id: generic-unused-variable
    pattern: |
      let $VAR = $VALUE;
      ...
    message: "Rule 8: Remove unused code. Clean code is safe code - remove unused variables"
    languages: [javascript, typescript]
    severity: INFO
    metadata:
      category: code-quality
      rule: "Generic Rule 8"
  
  # Rule 9: Use Version Control Properly
  # Why: Track changes safely
  # Note: Version control usage is enforced through Git workflows and commit practices
  # Ensure meaningful commit messages and proper branching strategies
  
  # ==========================================
  # JAVASCRIPT CODING STANDARDS
  # ==========================================
  
  - id: no-console-log
    pattern: console.log(...)
    message: Avoid console.log in production code. Use proper logging library
    languages: [javascript, typescript]
    severity: INFO
    metadata:
      category: best-practice

  - id: no-console-debug
    pattern: console.debug(...)
    message: Avoid console.debug in production code
    languages: [javascript, typescript]
    severity: INFO

  # 2.3 Use const instead of let
  - id: prefer-const
    pattern: let $X = $Y
    message: Use const instead of let if value is not reassigned
    languages: [javascript, typescript]
    severity: INFO
    metadata:
      category: best-practice

  # 2.4 Meaningful Variable Names
  - id: single-letter-var
    pattern: |
      let $X = $Y;
    message: Avoid single-letter variable names. Use meaningful names
    languages: [javascript, typescript]
    severity: INFO
    metadata:
      category: naming-convention

  # 2.5 Empty Catch Blocks
  - id: empty-catch-block
    pattern: |
      try {
        ...
      } catch ($E) {
      }
    message: Never ignore errors. Handle exceptions properly with logging or re-throwing
    languages: [javascript, typescript]
    severity: ERROR
    metadata:
      category: error-handling

  # 2.6 Hard-coded Credentials
  - id: hardcoded-password
    pattern-either:
      - pattern: var $PASSWORD = "..."
      - pattern: let $PASSWORD = "..."
      - pattern: const $PASSWORD = "..."
    message: Never hard-code passwords. Use environment variables
    languages: [javascript, typescript]
    severity: ERROR
    metadata:
      category: security
      cwe: CWE-798

  - id: hardcoded-api-key
    pattern-either:
      - pattern: var $API_KEY = "..."
      - pattern: let $API_KEY = "..."
      - pattern: const $API_KEY = "..."
    message: Never hard-code API keys. Use environment variables
    languages: [javascript, typescript]
    severity: ERROR
    metadata:
      category: security

  # 2.7 Magic Numbers
  - id: magic-numbers
    pattern: if ($X > $NUM)
    message: Avoid magic numbers. Use named constants
    languages: [javascript, typescript]
    severity: INFO
    metadata:
      category: best-practice

  # ==========================================
  # 20 ESSENTIAL JAVASCRIPT CODING RULES
  # ==========================================
  # These rules enforce best practices, security, and maintainability
  # for JavaScript/TypeScript codebases

  # Rule 1: Use Strict Equality
  # Why: Prevents unexpected type coercion
  - id: js-rule-1-strict-equality-check
    pattern-either:
      - pattern: if ($X == $Y) { ... }
      - pattern: while ($X == $Y) { ... }
      - pattern: $VAR = $X == $Y
    message: "Rule 1: Use strict equality (===) instead of == to prevent unexpected type coercion"
    languages: [javascript, typescript]
    severity: WARNING
    metadata:
      category: best-practice
      rule: "JS Rule 1"

  - id: js-rule-1-strict-inequality-check
    pattern-either:
      - pattern: if ($X != $Y) { ... }
      - pattern: while ($X != $Y) { ... }
      - pattern: $VAR = $X != $Y
    message: "Rule 1: Use strict inequality (!==) instead of != to prevent unexpected type coercion"
    languages: [javascript, typescript]
    severity: WARNING
    metadata:
      category: best-practice
      rule: "JS Rule 1"

  # Rule 2: Use const or let (Never var)
  # Why: Avoids scope and hoisting issues
  - id: js-rule-2-no-var
    pattern: var $VAR = $VALUE
    message: "Rule 2: Never use 'var'. Use 'const' or 'let' to avoid scope and hoisting issues"
    languages: [javascript, typescript]
    severity: ERROR
    metadata:
      category: best-practice
      rule: "JS Rule 2"

  # Rule 3: Prefer const Over let
  # Why: Prevents accidental reassignment
  - id: js-rule-3-prefer-const
    pattern: let $VAR = $VALUE
    message: "Rule 3: Prefer 'const' over 'let' to prevent accidental reassignment (use let only if reassignment is needed)"
    languages: [javascript, typescript]
    severity: INFO
    metadata:
      category: best-practice
      rule: "JS Rule 3"

  # Rule 4: Use Meaningful Variable Names
  # Why: Improves readability and understanding
  - id: js-rule-4-meaningful-names
    pattern-either:
      - pattern: const $X = ...
      - pattern: let $X = ...
    message: "Rule 4: Use meaningful variable names. Avoid single-letter names except for loop counters"
    languages: [javascript, typescript]
    severity: INFO
    metadata:
      category: naming-convention
      rule: "JS Rule 4"

  # Rule 5: Always Handle Errors
  # Why: Prevents silent failures and crashes
  - id: js-rule-5-empty-catch
    pattern: |
      try {
        ...
      } catch ($E) {
      }
    message: "Rule 5: Always handle errors. Never leave catch blocks empty - log errors or rethrow them"
    languages: [javascript, typescript]
    severity: ERROR
    metadata:
      category: error-handling
      rule: "JS Rule 5"

  # Rule 6: Handle Promises Properly
  # Why: Avoids unhandled promise rejections
  # NOTE: This rule may have some false positives on complex promise chains
  - id: js-rule-6-promise-without-catch
    pattern: $PROMISE.then($HANDLER);
    message: "Rule 6: Handle promises properly. Always add .catch() to handle rejections"
    languages: [javascript, typescript]
    severity: WARNING
    metadata:
      category: async-patterns
      rule: "JS Rule 6"

  # Rule 7: Prefer async/await
  # Why: Improves readability and control flow
  - id: js-rule-7-prefer-async-await
    pattern: |
      $FUNC().then($HANDLER1).then($HANDLER2)
    message: "Rule 7: Prefer async/await over promise chains for better readability and control flow"
    languages: [javascript, typescript]
    severity: INFO
    metadata:
      category: async-patterns
      rule: "JS Rule 7"

  # Rule 8: Avoid console.log in Production
  # Why: Prevents leaking sensitive information
  - id: js-rule-8-no-console-production
    pattern-either:
      - pattern: console.log(...)
      - pattern: console.debug(...)
      - pattern: console.info(...)
      - pattern: console.warn(...)
    message: "Rule 8: Avoid console statements in production. Use a proper logging library (e.g., winston, pino)"
    languages: [javascript, typescript]
    severity: WARNING
    metadata:
      category: best-practice
      rule: "JS Rule 8"

  # Rule 9: Avoid Magic Numbers
  # Why: Makes code easier to understand and modify
  - id: js-rule-9-magic-numbers
    pattern-either:
      - pattern: if ($VAR > $NUM) { ... }
      - pattern: if ($VAR < $NUM) { ... }
      - pattern: if ($VAR >= $NUM) { ... }
      - pattern: if ($VAR <= $NUM) { ... }
    message: "Rule 9: Avoid magic numbers. Use named constants (e.g., const MAX_RETRIES = 3)"
    languages: [javascript, typescript]
    severity: INFO
    metadata:
      category: best-practice
      rule: "JS Rule 9"

  # Rule 10: Validate Inputs
  # Why: Prevents runtime and security issues
  - id: js-rule-10-missing-validation
    pattern: |
      function $FUNC($PARAM) {
        $DB.save($PARAM);
      }
    message: "Rule 10: Validate inputs before using them. Check for null/undefined and validate data types"
    languages: [javascript, typescript]
    severity: WARNING
    metadata:
      category: security
      rule: "JS Rule 10"

  # Rule 11: Do Not Modify Function Parameters
  # Why: Avoids unexpected side effects
  - id: js-rule-11-no-param-mutation
    pattern-either:
      - pattern: |
          function $FUNC($PARAM) {
            $PARAM.$PROP = ...;
            ...
          }
      - pattern: |
          function $FUNC($PARAM) {
            $PARAM = ...;
            ...
          }
    message: "Rule 11: Do not modify function parameters. Return new objects to avoid side effects"
    languages: [javascript, typescript]
    severity: WARNING
    metadata:
      category: best-practice
      rule: "JS Rule 11"

  # Rule 12: Avoid eval()
  # Why: Prevents security vulnerabilities
  - id: js-rule-12-no-eval
    pattern: eval($X)
    message: "Rule 12: Never use eval(). It executes arbitrary code and is a major security risk"
    languages: [javascript, typescript]
    severity: ERROR
    metadata:
      category: security
      cwe: CWE-95
      rule: "JS Rule 12"

  # Rule 13: Avoid innerHTML with User Data
  # Why: Prevents XSS attacks
  - id: js-rule-13-no-innerhtml
    pattern-either:
      - pattern: $EL.innerHTML = $VAR
      - pattern: $EL.outerHTML = $VAR
    message: "Rule 13: Avoid innerHTML with user data. Use textContent or sanitize input to prevent XSS attacks"
    languages: [javascript, typescript]
    severity: ERROR
    metadata:
      category: security
      cwe: CWE-79
      rule: "JS Rule 13"

  # Rule 14: Always Specify Radix in parseInt
  # Why: Ensures consistent number parsing
  - id: js-rule-14-parseint-radix
    pattern: parseInt($X)
    message: "Rule 14: Always specify radix in parseInt(). Use parseInt(value, 10) for decimal numbers"
    languages: [javascript, typescript]
    severity: WARNING
    metadata:
      category: best-practice
      rule: "JS Rule 14"

  # Rule 15: Avoid async inside forEach
  # Why: forEach does not wait for async operations
  - id: js-rule-15-no-async-foreach
    pattern: |
      $ARR.forEach(async ($ITEM) => {
        ...
      })
    message: "Rule 15: Avoid async inside forEach. Use for...of loop or Promise.all() with map()"
    languages: [javascript, typescript]
    severity: ERROR
    metadata:
      category: async-patterns
      rule: "JS Rule 15"

  # Rule 16: Avoid Floating Promises
  # Why: Ensures errors are handled
  # NOTE: DISABLED - This rule produces too many false positives
  # Semgrep cannot distinguish async functions from regular functions without type info
  # Uncomment only if you have a way to identify async functions specifically
  # - id: js-rule-16-floating-promise-DISABLED
  #   pattern: |
  #     $ASYNC_FUNC();
  #   message: "Rule 16: Avoid floating promises. Use await or .catch() to handle errors properly"
  #   languages: [javascript, typescript]
  #   severity: WARNING
  #   metadata:
  #     category: async-patterns
  #     rule: "JS Rule 16"

  # Rule 17: Do Not Hard-Code Secrets
  # Why: Protects sensitive data
  # NOTE: Improved to match actual secret patterns
  - id: js-rule-17-no-hardcoded-secrets
    pattern-either:
      # Stripe API keys
      - pattern: const $VAR = "sk_live_..."
      - pattern: let $VAR = "sk_live_..."
      - pattern: const $VAR = "sk_test_..."
      - pattern: let $VAR = "sk_test_..."
      # GitHub tokens
      - pattern: const $VAR = "ghp_..."
      - pattern: let $VAR = "ghp_..."
      - pattern: const $VAR = "gho_..."
      - pattern: let $VAR = "gho_..."
      # AWS keys
      - pattern: const $VAR = "AKIA..."
      - pattern: let $VAR = "AKIA..."
      # Private keys
      - pattern: const $VAR = "-----BEGIN PRIVATE KEY-----"
      - pattern: let $VAR = "-----BEGIN PRIVATE KEY-----"
      - pattern: const $VAR = "-----BEGIN RSA PRIVATE KEY-----"
      - pattern: let $VAR = "-----BEGIN RSA PRIVATE KEY-----"
    message: "Rule 17: Do not hard-code secrets. Use environment variables (process.env.SECRET_NAME)"
    languages: [javascript, typescript]
    severity: ERROR
    metadata:
      category: security
      cwe: CWE-798
      rule: "JS Rule 17"

  # Rule 18: Use Default Parameters
  # Why: Handles falsy values correctly
  - id: js-rule-18-default-params
    pattern: |
      function $FUNC($PARAM) {
        if (!$PARAM) {
          $PARAM = $DEFAULT;
        }
        ...
      }
    message: "Rule 18: Use default parameters instead of manual checks (e.g., function log(level = 'info'))"
    languages: [javascript, typescript]
    severity: INFO
    metadata:
      category: best-practice
      rule: "JS Rule 18"

  # Rule 19: Reduce Nested Code
  # Why: Improves readability
  - id: js-rule-19-reduce-nesting
    pattern: |
      if ($COND1) {
        if ($COND2) {
          if ($COND3) {
            ...
          }
        }
      }
    message: "Rule 19: Reduce nested code. Use early returns to improve readability"
    languages: [javascript, typescript]
    severity: INFO
    metadata:
      category: code-quality
      rule: "JS Rule 19"

  # Rule 20: One Function Should Do One Thing
  # Why: Simplifies testing and maintenance
  - id: js-rule-20-single-responsibility
    pattern: |
      function $FUNC(...) {
        ...
        ...
        ...
        ...
        ...
        ...
        ...
        ...
        ...
        ...
        ...
        ...
      }
    message: "Rule 20: One function should do one thing. Break down large functions following Single Responsibility Principle"
    languages: [javascript, typescript]
    severity: WARNING
    metadata:
      category: code-quality
      rule: "JS Rule 20"

  # ==========================================
  # JAVA CODING STANDARDS
  # ==========================================

  # 4.1 Empty Catch Blocks (Java)
  - id: java-empty-catch
    pattern: |
      try {
        ...
      } catch (Exception $E) {
      }
    message: Never ignore exceptions. Handle them properly with logging
    languages: [java]
    severity: ERROR
    metadata:
      category: error-handling

  # 4.2 System.out.println in Production
  - id: java-system-out
    pattern: System.out.println(...)
    message: Avoid System.out.println. Use proper logging framework (log4j, slf4j)
    languages: [java]
    severity: WARNING
    metadata:
      category: best-practice

  # 4.3 Hard-coded Credentials (Java)
  - id: java-hardcoded-password
    pattern: String $PASSWORD = "...";
    message: Never hard-code passwords. Use environment variables or configuration
    languages: [java]
    severity: ERROR
    metadata:
      category: security
      cwe: CWE-798

  # 4.4 Use Interface Instead of Implementation
  - id: java-use-interface
    pattern: ArrayList $VAR = new ArrayList(...);
    message: Use List interface instead of ArrayList implementation
    languages: [java]
    severity: INFO
    metadata:
      category: best-practice
    fix: List $VAR = new ArrayList(...);

  - id: java-use-map-interface
    pattern: HashMap $VAR = new HashMap(...);
    message: Use Map interface instead of HashMap implementation
    languages: [java]
    severity: INFO
    metadata:
      category: best-practice
    fix: Map $VAR = new HashMap(...);

  # 4.5 Magic Numbers (Java)
  # Note: This rule is commented out due to parsing limitations
  # Manually review code for magic numbers in Java files

  # 4.6 Public Fields
  - id: java-public-fields
    pattern: public $TYPE $FIELD;
    message: Fields should be private. Use getters/setters for access
    languages: [java]
    severity: WARNING
    metadata:
      category: encapsulation

  # 4.7 Proper Exception Handling
  - id: java-catch-exception
    pattern: |
      catch (Exception $E) {
        System.out.println($E);
      }
    message: Avoid generic exception handling. Use specific exceptions and proper logging
    languages: [java]
    severity: WARNING
    metadata:
      category: error-handling

  # ==========================================
  # GO (GOLANG) CODING STANDARDS
  # ==========================================

  # 3.1 Error Handling in Go
  - id: go-unhandled-error
    pattern: |
      $X, err := $FUNC(...)
      $Y
    message: Handle errors immediately. Check if err != nil
    languages: [go]
    severity: ERROR
    metadata:
      category: error-handling

  # 3.2 Avoid Panic
  - id: go-avoid-panic
    pattern: panic($X)
    message: Avoid using panic. Return errors instead
    languages: [go]
    severity: WARNING
    metadata:
      category: error-handling

  # 3.3 Global Variables
  - id: go-global-var
    pattern: var $GLOBAL $TYPE
    message: Avoid global variables. Use local scope when possible
    languages: [go]
    severity: INFO
    metadata:
      category: best-practice

  # 3.4 Magic Numbers (Go)
  # Note: This rule is commented out due to parsing limitations
  # Manually review code for magic numbers in Go files

  # 3.5 Unclosed Channels
  - id: go-unclosed-channel
    pattern: |
      $CH := make(chan $TYPE)
      ...
    message: Ensure channels are properly closed to avoid goroutine leaks
    languages: [go]
    severity: WARNING
    metadata:
      category: concurrency

  # ==========================================
  # PYTHON CODING STANDARDS
  # ==========================================

  # Python: Empty Except Blocks
  - id: python-empty-except
    pattern: |
      try:
        ...
      except:
        pass
    message: Never ignore exceptions. Handle them properly
    languages: [python]
    severity: ERROR
    metadata:
      category: error-handling

  # Python: Bare Except
  - id: python-bare-except
    pattern: |
      try:
        ...
      except:
        ...
    message: Avoid bare except. Catch specific exceptions
    languages: [python]
    severity: WARNING
    metadata:
      category: error-handling

  # Python: Print Statements
  - id: python-print-statement
    pattern: print(...)
    message: Avoid print statements in production. Use logging module
    languages: [python]
    severity: INFO
    metadata:
      category: best-practice

  # ==========================================
  # SECURITY RULES (ALL LANGUAGES)
  # ==========================================

  # SQL Injection
  - id: sql-injection-risk
    pattern-either:
      - pattern: $DB.execute("... " + $VAR + " ...")
      - pattern: $DB.query("... " + $VAR + " ...")
    message: Potential SQL injection vulnerability. Use parameterized queries
    languages: [javascript, typescript, python, java]
    severity: ERROR
    metadata:
      category: security
      cwe: CWE-89

  # Eval Usage
  - id: dangerous-eval
    pattern: eval($X)
    message: Avoid using eval(). It can execute arbitrary code and is a security risk
    languages: [javascript, typescript, python]
    severity: ERROR
    metadata:
      category: security
      cwe: CWE-95

  # ==========================================
  # CODE QUALITY RULES
  # ==========================================

  # Duplicate Code
  - id: duplicate-if-conditions
    pattern: |
      if ($COND) {
        $BODY
      }
      ...
      if ($COND) {
        $BODY
      }
    message: Duplicate code detected. Follow DRY principle
    languages: [javascript, typescript, java, go]
    severity: INFO
    metadata:
      category: code-quality

  # Long Functions (Heuristic)
  - id: function-too-long
    pattern: |
      function $FUNC(...) {
        ...
        ...
        ...
        ...
        ...
        ...
        ...
        ...
        ...
        ...
      }
    message: Function is too long. Consider breaking it into smaller functions (Single Responsibility Principle)
    languages: [javascript, typescript]
    severity: INFO
    metadata:
      category: code-quality

  # ==========================================
  # INPUT VALIDATION
  # ==========================================

  # Missing Input Validation
  - id: missing-input-validation
    pattern: |
      function $FUNC($PARAM) {
        $DB.save($PARAM);
      }
    message: Missing input validation. Validate parameters before using them
    languages: [javascript, typescript]
    severity: WARNING
    metadata:
      category: security

  # ==========================================
  # PERFORMANCE RULES
  # ==========================================

  # Inefficient Loop
  - id: inefficient-array-push-in-loop
    pattern: |
      for (...) {
        $ARR.push($ITEM);
      }
    message: Consider using array methods like map() or filter() for better performance
    languages: [javascript, typescript]
    severity: INFO
    metadata:
      category: performance

  # ==========================================
  # DOCUMENTATION RULES
  # ==========================================

  # ==========================================
  # FILE HEADER DOCUMENTATION (MANDATORY)
  # Note: These rules check for required header comments
  # For comprehensive validation, use the header-validator.py script
  # ==========================================

  # Missing Function Documentation
  - id: missing-function-doc
    pattern: |
      function $FUNC($PARAMS) {
        ...
      }
    message: Add documentation comments to explain the purpose of this function
    languages: [javascript, typescript]
    severity: INFO
    metadata:
      category: documentation

  # ==========================================
  # NAMING CONVENTION RULES
  # ==========================================

  # Class Naming (Java)
  - id: java-class-naming
    pattern: class $CLASS { ... }
    message: Class names should use PascalCase
    languages: [java]
    severity: INFO
    metadata:
      category: naming-convention

  # Constant Naming (Java)
  - id: java-constant-naming
    pattern: |
      public static final $TYPE $NAME = ...;
    message: Constants should use UPPER_CASE naming convention
    languages: [java]
    severity: INFO
    metadata:
      category: naming-convention

  # ==========================================
  # ADVANCED JAVASCRIPT/TYPESCRIPT RULES
  # ==========================================

  # Async/Await Best Practices
  - id: missing-await
    pattern: |
      async function $FUNC(...) {
        $PROMISE();
      }
    message: Async function should use await for promises
    languages: [javascript, typescript]
    severity: WARNING
    metadata:
      category: async-patterns

  # Promise without catch
  - id: promise-without-catch
    pattern: $PROMISE.then(...)
    message: Promise should have .catch() or try-catch for error handling
    languages: [javascript, typescript]
    severity: WARNING
    metadata:
      category: error-handling

  # Callback Hell Detection
  - id: callback-hell
    pattern: |
      function $F1(..., function(...) {
        function $F2(..., function(...) {
          ...
        });
      });
    message: Avoid callback hell. Use Promises or async/await
    languages: [javascript, typescript]
    severity: WARNING
    metadata:
      category: code-quality

  # Floating Promises
  - id: floating-promise
    pattern: |
      $ASYNC_FUNC();
    message: Floating promise detected. Use await or .catch() to handle errors
    languages: [javascript, typescript]
    severity: WARNING
    metadata:
      category: async-patterns

  # Unsafe parseInt
  - id: unsafe-parseint
    pattern: parseInt($X)
    message: Always specify radix parameter in parseInt(). Use parseInt($X, 10)
    languages: [javascript, typescript]
    severity: WARNING
    metadata:
      category: best-practice

  # Array.forEach with async
  - id: async-foreach
    pattern: |
      $ARR.forEach(async ($ITEM) => {
        ...
      })
    message: forEach doesn't wait for async callbacks. Use for...of or Promise.all()
    languages: [javascript, typescript]
    severity: ERROR
    metadata:
      category: async-patterns

  # Unvalidated Redirect
  - id: unvalidated-redirect
    pattern-either:
      - pattern: window.location = $URL
      - pattern: window.location.href = $URL
    message: Unvalidated redirect can lead to phishing attacks. Validate URL first
    languages: [javascript, typescript]
    severity: ERROR
    metadata:
      category: security
      cwe: CWE-601

  # Weak Crypto
  - id: weak-crypto-md5
    pattern-either:
      - pattern: crypto.createHash("md5")
      - pattern: crypto.createHash('md5')
    message: MD5 is cryptographically broken. Use SHA-256 or stronger
    languages: [javascript, typescript]
    severity: ERROR
    metadata:
      category: security
      cwe: CWE-327

  # Insecure Random
  - id: insecure-random
    pattern: Math.random()
    message: Math.random() is not cryptographically secure. Use crypto.randomBytes()
    languages: [javascript, typescript]
    severity: WARNING
    metadata:
      category: security

  # DOM XSS
  - id: dom-xss-innerhtml
    pattern: $EL.innerHTML = $VAR
    message: Setting innerHTML with user input can cause XSS. Use textContent or sanitize input
    languages: [javascript, typescript]
    severity: ERROR
    metadata:
      category: security
      cwe: CWE-79

  # Prototype Pollution
  - id: prototype-pollution
    pattern-either:
      - pattern: $OBJ["__proto__"] = ...
      - pattern: $OBJ.constructor.prototype = ...
    message: Prototype pollution vulnerability detected
    languages: [javascript, typescript]
    severity: ERROR
    metadata:
      category: security
      cwe: CWE-1321

  # Missing return in array callback
  - id: missing-return-in-map
    pattern: |
      $ARR.map(($ITEM) => {
        $BODY
      })
    message: Array.map callback should return a value
    languages: [javascript, typescript]
    severity: WARNING
    metadata:
      category: best-practice

  # ==========================================
  # ADVANCED JAVA RULES
  # ==========================================

  # Null Pointer Risk
  - id: java-null-check-missing
    pattern: |
      if ($OBJ != null) {
        $OBJ.$METHOD(...);
      }
      $OBJ.$METHOD2(...);
    message: Potential null pointer exception. Check for null before use
    languages: [java]
    severity: WARNING
    metadata:
      category: null-safety

  # String Comparison with ==
  - id: java-string-equality
    pattern: $STR1 == $STR2
    message: Use .equals() for string comparison, not ==
    languages: [java]
    severity: ERROR
    metadata:
      category: best-practice

  # Resource Leak
  - id: java-resource-leak
    pattern: |
      $RES = new FileInputStream(...);
    message: Resource may not be closed. Use try-with-resources
    languages: [java]
    severity: WARNING
    metadata:
      category: resource-management

  # Inefficient String Concatenation
  - id: java-string-concat-loop
    pattern: |
      for (...) {
        $STR = $STR + $X;
      }
    message: Use StringBuilder for string concatenation in loops
    languages: [java]
    severity: WARNING
    metadata:
      category: performance

  # Thread.sleep in loop
  - id: java-sleep-in-loop
    pattern: |
      while (...) {
        Thread.sleep(...);
      }
    message: Avoid Thread.sleep() in loops. Use ScheduledExecutorService
    languages: [java]
    severity: WARNING
    metadata:
      category: concurrency

  # Weak Hashing
  - id: java-weak-hash
    pattern-either:
      - pattern: MessageDigest.getInstance("MD5")
      - pattern: MessageDigest.getInstance("SHA1")
    message: MD5 and SHA1 are weak. Use SHA-256 or stronger
    languages: [java]
    severity: ERROR
    metadata:
      category: security
      cwe: CWE-327

  # SQL Injection via Statement
  - id: java-sql-injection
    pattern: |
      Statement $STMT = ...;
      $STMT.execute("... " + $VAR + " ...");
    message: SQL injection vulnerability. Use PreparedStatement
    languages: [java]
    severity: ERROR
    metadata:
      category: security
      cwe: CWE-89

  # Hardcoded IP Address
  - id: java-hardcoded-ip
    pattern: String $IP = "$NUM.$NUM.$NUM.$NUM"
    message: Avoid hardcoding IP addresses. Use configuration
    languages: [java]
    severity: WARNING
    metadata:
      category: configuration

  # ==========================================
  # ADVANCED GO RULES
  # ==========================================

  # Defer in loop
  - id: go-defer-in-loop
    pattern: |
      for ... {
        defer $FUNC(...)
      }
    message: Defer in loop can cause resource exhaustion. Move defer outside loop
    languages: [go]
    severity: ERROR
    metadata:
      category: resource-management

  # Goroutine leak
  - id: go-goroutine-leak
    pattern: |
      go func() {
        ...
      }()
    message: Ensure goroutines can exit to prevent leaks. Use context or done channel
    languages: [go]
    severity: WARNING
    metadata:
      category: concurrency

  # Empty interface usage
  - id: go-empty-interface
    pattern: func $FUNC($PARAM interface{})
    message: Avoid empty interface. Use specific types or generics (Go 1.18+)
    languages: [go]
    severity: INFO
    metadata:
      category: type-safety

  # Time.After in loop
  - id: go-time-after-leak
    pattern: |
      for ... {
        <-time.After(...)
      }
    message: time.After in loop causes memory leak. Use time.NewTicker instead
    languages: [go]
    severity: ERROR
    metadata:
      category: memory-leak

  # Weak Random
  - id: go-weak-random
    pattern: rand.Read(...)
    message: Use crypto/rand for security-sensitive random numbers
    languages: [go]
    severity: WARNING
    metadata:
      category: security

  # SQL Injection
  - id: go-sql-injection
    pattern: $DB.Query("... " + $VAR + " ...")
    message: SQL injection risk. Use parameterized queries
    languages: [go]
    severity: ERROR
    metadata:
      category: security
      cwe: CWE-89

  # ==========================================
  # ADVANCED PYTHON RULES
  # ==========================================

  # Mutable Default Argument
  - id: python-mutable-default
    pattern-either:
      - pattern: |
          def $FUNC($PARAM=[]):
            ...
      - pattern: |
          def $FUNC($PARAM={}):
            ...
    message: Mutable default arguments are dangerous. Use None and initialize inside function
    languages: [python]
    severity: ERROR
    metadata:
      category: best-practice

  # Assert in production
  - id: python-assert-usage
    pattern: assert $COND
    message: Don't use assert for validation. Assertions can be disabled with -O flag
    languages: [python]
    severity: WARNING
    metadata:
      category: best-practice

  # Weak Hashing
  - id: python-weak-hash
    pattern-either:
      - pattern: hashlib.md5(...)
      - pattern: hashlib.sha1(...)
    message: MD5 and SHA1 are cryptographically broken. Use SHA-256 or stronger
    languages: [python]
    severity: ERROR
    metadata:
      category: security
      cwe: CWE-327

  # Pickle Security
  - id: python-pickle-unsafe
    pattern: pickle.loads($DATA)
    message: pickle.loads() can execute arbitrary code. Never unpickle untrusted data
    languages: [python]
    severity: ERROR
    metadata:
      category: security
      cwe: CWE-502

  # Shell Injection
  - id: python-shell-injection
    pattern: os.system($CMD)
    message: os.system() is vulnerable to shell injection. Use subprocess with shell=False
    languages: [python]
    severity: ERROR
    metadata:
      category: security
      cwe: CWE-78

  # Hardcoded Temp Path
  - id: python-hardcoded-temp
    pattern-either:
      - pattern: open("/tmp/...")
      - pattern: open("/var/tmp/...")
    message: Hardcoded temp paths are insecure. Use tempfile module
    languages: [python]
    severity: WARNING
    metadata:
      category: security

  # Requests without timeout
  - id: python-requests-no-timeout
    pattern: requests.$METHOD($URL)
    message: HTTP requests should have timeout to prevent hanging
    languages: [python]
    severity: WARNING
    metadata:
      category: reliability

  # SQL Injection
  - id: python-sql-injection
    pattern: |
      $CURSOR.execute("... " + $VAR + " ...")
    message: SQL injection vulnerability. Use parameterized queries
    languages: [python]
    severity: ERROR
    metadata:
      category: security
      cwe: CWE-89

  # Dangerous YAML load
  - id: python-yaml-unsafe
    pattern: yaml.load($DATA)
    message: yaml.load() can execute arbitrary code. Use yaml.safe_load()
    languages: [python]
    severity: ERROR
    metadata:
      category: security
      cwe: CWE-502

  # ==========================================
  # CROSS-LANGUAGE SECURITY RULES
  # ==========================================

  # Regex DoS (ReDoS)
  - id: regex-dos-risk
    pattern-either:
      - pattern: $REGEX = /(.+)+/
      - pattern: $REGEX = /(.*)*/ 
    message: Regex with nested quantifiers can cause ReDoS attacks
    languages: [javascript, typescript, python, java]
    severity: ERROR
    metadata:
      category: security
      cwe: CWE-1333

  # Hardcoded Secret Token
  - id: hardcoded-token
    pattern-either:
      - pattern: $TOKEN = "sk_live_..."
      - pattern: $TOKEN = "ghp_..."
      - pattern: $SECRET = "-----BEGIN PRIVATE KEY-----"
    message: Hardcoded secret token detected. Use environment variables or secret management
    languages: [javascript, typescript, python, java, go]
    severity: ERROR
    metadata:
      category: security
      cwe: CWE-798

  # ==========================================
  # 20 ESSENTIAL GOLANG CODING RULES
  # ==========================================
  # These rules enforce Go best practices, idioms, and security

  # Rule 1: Always Handle Errors Immediately
  # Why: Ignoring errors can cause silent failures
  - id: go-rule-1-unhandled-error
    pattern: |
      $X, err := $FUNC(...)
    message: "Rule 1: Always handle errors immediately. Check if err != nil after assignment"
    languages: [go]
    severity: WARNING
    metadata:
      category: error-handling
      rule: "Go Rule 1"

  # Rule 2: Do Not Ignore Returned Errors
  # Why: Go enforces explicit error handling
  # NOTE: This rule is informational - manual review recommended
  - id: go-rule-2-ignored-error
    pattern: $FUNC(...)
    message: "Rule 2: Ensure function errors are checked (informational - review manually)"
    languages: [go]
    severity: INFO
    metadata:
      category: error-handling
      rule: "Go Rule 2"

  # Rule 3: Avoid panic in Application Code
  # Why: Panic crashes the program
  - id: go-rule-3-avoid-panic
    pattern: panic($X)
    message: "Rule 3: Avoid using panic in application code. Return errors instead"
    languages: [go]
    severity: WARNING
    metadata:
      category: error-handling
      rule: "Go Rule 3"

  # Rule 4: Use Named Return Values Carefully
  # Why: Overuse reduces readability
  - id: go-rule-4-named-returns
    pattern: |
      func $FUNC(...) (... $NAME ...) {
        ...
        return
      }
    message: "Rule 4: Use named return values carefully. Ensure they improve clarity"
    languages: [go]
    severity: INFO
    metadata:
      category: best-practice
      rule: "Go Rule 4"

  # Rule 5: Prefer Short Variable Declarations
  # Why: Keeps code concise and idiomatic
  - id: go-rule-5-var-declaration
    pattern: var $VAR $TYPE = $VALUE
    message: "Rule 5: Prefer short variable declarations (:=) inside functions"
    languages: [go]
    severity: INFO
    metadata:
      category: best-practice
      rule: "Go Rule 5"

  # Rule 6: Avoid Global Variables
  # Why: Global state makes code harder to test
  - id: go-rule-6-global-var
    pattern: var $GLOBAL $TYPE
    message: "Rule 6: Avoid global variables. Use dependency injection or structs"
    languages: [go]
    severity: INFO
    metadata:
      category: best-practice
      rule: "Go Rule 6"

  # Rule 7: Always Close Resources
  # Why: Unclosed resources cause leaks
  # NOTE: Simplified pattern - manual review recommended
  - id: go-rule-7-unclosed-resource
    pattern: |
      $RES, err := os.Open(...)
    message: "Rule 7: Ensure resources are closed. Use defer to ensure cleanup"
    languages: [go]
    severity: INFO
    metadata:
      category: resource-management
      rule: "Go Rule 7"

  # Rule 8: Do Not Use defer Inside Loops
  # Why: Defers inside loops can exhaust resources
  - id: go-rule-8-defer-in-loop
    pattern: |
      for ... {
        defer $FUNC(...)
      }
    message: "Rule 8: Do not use defer inside loops. Move defer outside or use a function"
    languages: [go]
    severity: ERROR
    metadata:
      category: resource-management
      rule: "Go Rule 8"

  # Rule 9: Use Context for Cancellation
  # Why: Prevents goroutine leaks
  # NOTE: Informational - check long-running functions manually
  - id: go-rule-9-missing-context
    pattern: |
      func $FUNC(...) error {
        ...
      }
    message: "Rule 9: Consider using context.Context for cancellation in long-running functions"
    languages: [go]
    severity: INFO
    metadata:
      category: concurrency
      rule: "Go Rule 9"

  # Rule 10: Avoid Goroutine Leaks
  # Why: Uncontrolled goroutines consume memory
  - id: go-rule-10-goroutine-leak
    pattern: |
      go func() {
        ...
      }()
    message: "Rule 10: Ensure goroutines can exit. Use context or done channels"
    languages: [go]
    severity: WARNING
    metadata:
      category: concurrency
      rule: "Go Rule 10"

  # Rule 11: Prefer Interfaces Over Concrete Types
  # Why: Improves flexibility and testability
  - id: go-rule-11-concrete-type-param
    pattern: |
      func $FUNC($PARAM *$TYPE) {
        ...
      }
    message: "Rule 11: Consider using interfaces instead of concrete types for better testability"
    languages: [go]
    severity: INFO
    metadata:
      category: best-practice
      rule: "Go Rule 11"

  # Rule 12: Avoid Empty Interface
  # Why: Loses type safety
  - id: go-rule-12-empty-interface
    pattern: func $FUNC($PARAM interface{})
    message: "Rule 12: Avoid empty interface (interface{}). Use specific types or generics"
    languages: [go]
    severity: WARNING
    metadata:
      category: type-safety
      rule: "Go Rule 12"

  # Rule 13: Use Channels Safely
  # Why: Unclosed channels cause goroutine leaks
  # NOTE: Informational - ensure channels are closed
  - id: go-rule-13-unclosed-channel
    pattern: |
      $CH := make(chan $TYPE)
    message: "Rule 13: Ensure channels are properly closed to avoid goroutine leaks"
    languages: [go]
    severity: INFO
    metadata:
      category: concurrency
      rule: "Go Rule 13"

  # Rule 14: Avoid time.After in Loops
  # Why: Creates memory leaks
  - id: go-rule-14-time-after-leak
    pattern: |
      for ... {
        <-time.After(...)
      }
    message: "Rule 14: Avoid time.After in loops. Use time.NewTicker instead"
    languages: [go]
    severity: ERROR
    metadata:
      category: memory-leak
      rule: "Go Rule 14"

  # Rule 15: Use crypto/rand for Security
  # Why: math/rand is not cryptographically secure
  - id: go-rule-15-weak-random
    pattern: rand.Read(...)
    message: "Rule 15: Use crypto/rand for security-sensitive random numbers, not math/rand"
    languages: [go]
    severity: WARNING
    metadata:
      category: security
      rule: "Go Rule 15"

  # Rule 16: Avoid Hard-Coded Secrets
  # Why: Hard-coded credentials are a security risk
  - id: go-rule-16-hardcoded-secrets
    pattern-either:
      - pattern: $VAR := "sk_live_..."
      - pattern: $VAR := "ghp_..."
      - pattern: $VAR := "AKIA..."
      - pattern: const $VAR = "..."
    message: "Rule 16: Do not hard-code secrets. Use environment variables (os.Getenv)"
    languages: [go]
    severity: ERROR
    metadata:
      category: security
      cwe: CWE-798
      rule: "Go Rule 16"

  # Rule 17: Use Struct Tags Correctly
  # Why: Ensures proper serialization
  - id: go-rule-17-missing-struct-tags
    pattern: |
      type $STRUCT struct {
        $FIELD $TYPE
      }
    message: "Rule 17: Use struct tags for JSON/XML serialization (e.g., `json:\"field_name\"`)"
    languages: [go]
    severity: INFO
    metadata:
      category: best-practice
      rule: "Go Rule 17"

  # Rule 18: Keep Functions Small and Focused
  # Why: Improves readability and testing
  - id: go-rule-18-long-function
    pattern: |
      func $FUNC(...) ... {
        ...
        ...
        ...
        ...
        ...
        ...
        ...
        ...
        ...
        ...
        ...
        ...
      }
    message: "Rule 18: Keep functions small and focused. Break down large functions"
    languages: [go]
    severity: INFO
    metadata:
      category: code-quality
      rule: "Go Rule 18"

  # Rule 19: Avoid SQL String Concatenation
  # Why: Prevents SQL injection
  - id: go-rule-19-sql-injection
    pattern: $DB.Query("... " + $VAR + " ...")
    message: "Rule 19: Avoid SQL string concatenation. Use parameterized queries"
    languages: [go]
    severity: ERROR
    metadata:
      category: security
      cwe: CWE-89
      rule: "Go Rule 19"

  # Rule 20: Follow Go Formatting (gofmt)
  # Why: Ensures consistent code style
  # Note: This is enforced by gofmt tool, not Semgrep
  # Run: gofmt -w *.go

  # ==========================================
  # 20 ESSENTIAL JAVA CODING RULES
  # ==========================================
  # These rules enforce Java best practices, security, and maintainability

  # Rule 1: Use .equals() for String Comparison
  # Why: == compares object references, not actual string values
  - id: java-rule-1-string-equals
    pattern: $STR1 == $STR2
    message: "Rule 1: Use .equals() for string comparison, not =="
    languages: [java]
    severity: ERROR
    metadata:
      category: best-practice
      rule: "Java Rule 1"

  # Rule 2: Avoid Using System.out.println in Production
  # Why: Proper logging frameworks provide levels and configurability
  - id: java-rule-2-no-system-out
    pattern-either:
      - pattern: System.out.println(...)
      - pattern: System.err.println(...)
    message: "Rule 2: Avoid System.out.println in production. Use proper logging framework (log4j, slf4j)"
    languages: [java]
    severity: WARNING
    metadata:
      category: best-practice
      rule: "Java Rule 2"

  # Rule 3: Always Handle Exceptions Properly
  # Why: Unhandled exceptions hide failures
  - id: java-rule-3-handle-exceptions
    pattern: |
      catch (Exception $E) {
        System.out.println($E);
      }
    message: "Rule 3: Handle exceptions properly. Use logger.error() instead of System.out"
    languages: [java]
    severity: WARNING
    metadata:
      category: error-handling
      rule: "Java Rule 3"

  # Rule 4: Do Not Leave Empty Catch Blocks
  # Why: Silently ignoring exceptions makes debugging impossible
  - id: java-rule-4-empty-catch
    pattern: |
      try {
        ...
      } catch (Exception $E) {
      }
    message: "Rule 4: Do not leave empty catch blocks. Log or rethrow exceptions"
    languages: [java]
    severity: ERROR
    metadata:
      category: error-handling
      rule: "Java Rule 4"

  # Rule 5: Use Try-With-Resources
  # Why: Ensures resources are closed automatically
  - id: java-rule-5-try-with-resources
    pattern: |
      $RES = new FileInputStream(...)
    message: "Rule 5: Use try-with-resources to ensure automatic resource cleanup"
    languages: [java]
    severity: INFO
    metadata:
      category: resource-management
      rule: "Java Rule 5"

  # Rule 6: Prefer Interfaces Over Implementations
  # Why: Improves flexibility and testability
  - id: java-rule-6-use-interface
    pattern-either:
      - pattern: ArrayList $VAR = new ArrayList(...)
      - pattern: HashMap $VAR = new HashMap(...)
      - pattern: HashSet $VAR = new HashSet(...)
    message: "Rule 6: Use interface types (List, Map, Set) instead of concrete implementations"
    languages: [java]
    severity: INFO
    metadata:
      category: best-practice
      rule: "Java Rule 6"

  # Rule 7: Keep Fields Private
  # Why: Encapsulation protects object integrity
  - id: java-rule-7-private-fields
    pattern: public $TYPE $FIELD;
    message: "Rule 7: Keep fields private. Use getters/setters for access"
    languages: [java]
    severity: WARNING
    metadata:
      category: encapsulation
      rule: "Java Rule 7"

  # Rule 8: Use Constants for Fixed Values
  # Why: Improves readability and maintainability
  - id: java-rule-8-magic-numbers
    pattern-either:
      - pattern: if ($VAR > $NUM) { ... }
      - pattern: if ($VAR < $NUM) { ... }
      - pattern: if ($VAR == $NUM) { ... }
    message: "Rule 8: Use constants for fixed values instead of magic numbers"
    languages: [java]
    severity: INFO
    metadata:
      category: best-practice
      rule: "Java Rule 8"

  # Rule 9: Avoid Hard-Coded Credentials
  # Why: Hard-coded secrets are a major security risk
  - id: java-rule-9-hardcoded-secrets
    pattern-either:
      - pattern: String $PASSWORD = "..."
      - pattern: String $API_KEY = "..."
      - pattern: String $SECRET = "..."
    message: "Rule 9: Do not hard-code credentials. Use environment variables or configuration"
    languages: [java]
    severity: ERROR
    metadata:
      category: security
      cwe: CWE-798
      rule: "Java Rule 9"

  # Rule 10: Use .equals() for Object Comparison
  # Why: Ensures correct logical comparison
  - id: java-rule-10-object-equals
    pattern: if ($OBJ1 == $OBJ2)
    message: "Rule 10: Use .equals() for object comparison, not =="
    languages: [java]
    severity: WARNING
    metadata:
      category: best-practice
      rule: "Java Rule 10"

  # Rule 11: Avoid Catching Generic Exception
  # Why: Catching specific exceptions improves clarity
  - id: java-rule-11-generic-exception
    pattern: catch (Exception $E)
    message: "Rule 11: Avoid catching generic Exception. Catch specific exceptions"
    languages: [java]
    severity: WARNING
    metadata:
      category: error-handling
      rule: "Java Rule 11"

  # Rule 12: Avoid Null Pointer Exceptions
  # Why: Null checks prevent runtime crashes
  - id: java-rule-12-null-check
    pattern: $OBJ.$METHOD(...)
    message: "Rule 12: Check for null before calling methods to avoid NullPointerException"
    languages: [java]
    severity: INFO
    metadata:
      category: null-safety
      rule: "Java Rule 12"

  # Rule 13: Use Optional to Handle Absence
  # Why: Makes null handling explicit and safer
  - id: java-rule-13-use-optional
    pattern: |
      if ($VAR == null) {
        return null;
      }
    message: "Rule 13: Consider using Optional<T> to handle absence explicitly"
    languages: [java]
    severity: INFO
    metadata:
      category: best-practice
      rule: "Java Rule 13"

  # Rule 14: Avoid String Concatenation in Loops
  # Why: Improves performance and memory usage
  - id: java-rule-14-string-concat-loop
    pattern: |
      for (...) {
        $STR = $STR + $X;
      }
    message: "Rule 14: Use StringBuilder for string concatenation in loops"
    languages: [java]
    severity: WARNING
    metadata:
      category: performance
      rule: "Java Rule 14"

  # Rule 15: Use PreparedStatement for SQL
  # Why: Prevents SQL injection attacks
  - id: java-rule-15-sql-injection
    pattern: |
      Statement $STMT = ...;
      $STMT.execute("... " + $VAR + " ...");
    message: "Rule 15: Use PreparedStatement to prevent SQL injection"
    languages: [java]
    severity: ERROR
    metadata:
      category: security
      cwe: CWE-89
      rule: "Java Rule 15"

  # Rule 16: Avoid Public Fields
  # Why: Preserves encapsulation and control
  - id: java-rule-16-no-public-fields
    pattern: |
      class $CLASS {
        public $TYPE $FIELD;
      }
    message: "Rule 16: Avoid public fields. Use private fields with getters/setters"
    languages: [java]
    severity: WARNING
    metadata:
      category: encapsulation
      rule: "Java Rule 16"

  # Rule 17: Make Methods Small and Focused
  # Why: Improves readability and testability
  - id: java-rule-17-long-method
    pattern: |
      $MODS $TYPE $METHOD(...) {
        ...
        ...
        ...
        ...
        ...
        ...
        ...
        ...
        ...
        ...
        ...
        ...
      }
    message: "Rule 17: Keep methods small and focused. Break down large methods"
    languages: [java]
    severity: INFO
    metadata:
      category: code-quality
      rule: "Java Rule 17"

  # Rule 18: Use Immutable Objects Where Possible
  # Why: Reduces bugs and improves thread safety
  - id: java-rule-18-immutable-class
    pattern: |
      public class $CLASS {
        private $TYPE $FIELD;
      }
    message: "Rule 18: Consider making classes immutable (final class, final fields)"
    languages: [java]
    severity: INFO
    metadata:
      category: best-practice
      rule: "Java Rule 18"

  # Rule 19: Avoid Thread.sleep() in Loops
  # Why: Leads to inefficient scheduling
  - id: java-rule-19-sleep-in-loop
    pattern: |
      while (...) {
        Thread.sleep(...);
      }
    message: "Rule 19: Avoid Thread.sleep() in loops. Use ScheduledExecutorService"
    languages: [java]
    severity: WARNING
    metadata:
      category: concurrency
      rule: "Java Rule 19"

  # Rule 20: Follow Java Naming Conventions
  # Why: Ensures consistency and readability
  - id: java-rule-20-class-naming
    pattern: class $CLASS { ... }
    message: "Rule 20: Follow Java naming conventions (PascalCase for classes)"
    languages: [java]
    severity: INFO
    metadata:
      category: naming-convention
      rule: "Java Rule 20"
